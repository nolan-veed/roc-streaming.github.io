<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Code structure &#8212; Roc Toolkit 0.3.0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=601dbdee" />
    <link rel="stylesheet" type="text/css" href="../_static/roc.css?v=37117d08" />
    <script src="../_static/documentation_options.js?v=e259d695"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/analytics.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Threads and queues" href="threads.html" />
    <link rel="prev" title="Glossary" href="glossary.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="threads.html" title="Threads and queues"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="glossary.html" title="Glossary"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Roc Toolkit 0.3.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../internals.html" accesskey="U">Internals</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Code structure</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="code-structure">
<h1>Code structure<a class="headerlink" href="#code-structure" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of contents:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id3">Overview</a></p></li>
<li><p><a class="reference internal" href="#modules" id="id4">Modules</a></p></li>
<li><p><a class="reference internal" href="#targets" id="id5">Targets</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/roc-streaming/roc-toolkit">Roc Toolkit</a> consists of the following high-level components:</p>
<ul>
<li><p><strong>Internal modules</strong></p>
<p>Internal C++ libraries, not part of public API. Basic building blocks for library and tools. See <a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/">Doxygen documentation</a> for details.</p>
</li>
<li><p><strong>C library</strong></p>
<p>Public C API (libroc) for C and C++ applications. See <a class="reference internal" href="../api.html"><span class="doc">API</span></a> page.</p>
</li>
<li><p><strong>Command-line tools</strong></p>
<p>Command-line tools for developers and advanced users. See <a class="reference internal" href="../tools/command_line_tools.html"><span class="doc">Command-line tools</span></a> page.</p>
</li>
</ul>
<p>Besides toolkit, <a class="reference external" href="https://github.com/roc-streaming">Roc Streaming</a> project provides some software on top of it:</p>
<ul>
<li><p><strong>Language bindings</strong></p>
<p>Library bindings for other programming languages. See <a class="reference internal" href="../api/bindings.html"><span class="doc">Bindings</span></a> page.</p>
</li>
<li><p><strong>Sound server modules</strong></p>
<p>Modules for OS-specific sound servers, like PulseAudio and PipeWire. See <a class="reference internal" href="../tools/sound_server_modules.html"><span class="doc">Sound server modules</span></a> page.</p>
</li>
<li><p><strong>Applications</strong></p>
<p>Desktop and mobile apps for end-users. See <a class="reference internal" href="../tools/applications.html"><span class="doc">Applications</span></a> page.</p>
</li>
</ul>
<img alt="Overview" class="align-center" src="../_images/code_structure.png" />
</section>
<section id="modules">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Modules</a><a class="headerlink" href="#modules" title="Link to this heading">¶</a></h2>
<p>Essentially, a module is just a C++ library providing a set of related classes. Every module has its own namespace, include path, and a set of unit tests. Modules may be built separately.</p>
<p>See <a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/">Doxygen documentation</a> for details.</p>
<p>Modules can be grouped into several layers, as shown on the diagram above:</p>
<ul class="simple">
<li><p>network I/O layer (roc_netio)</p></li>
<li><p>processing layer (roc_pipeline), with two sub-layers:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>packet processing sub-layer (roc_packet, roc_rtp, roc_rtcp, roc_fec, and others)</p></li>
<li><p>frame processing sub-layer (roc_audio)</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>sound I/O layer (roc_sndio)</p></li>
<li><p>control layer (roc_ctl)</p></li>
<li><p>node layer (roc_node)</p></li>
</ul>
<p>On receiver media flows from network I/O layer, through processing layer, to sound I/O layer. Accordingly, on sender media flows from sound I/O layer, through processing layer, to network I/O layer. On both receiver and sender, there is also control layer that handles various supportive tasks. Finally, node layer is a top-level layer which glues everything together.</p>
<p>Here is the full list of available modules:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>module</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1core.html">roc_core</a></p></td>
<td><p>General-purpose building blocks (containers, memory management, multithreading, etc)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1status.html">roc_status</a></p></td>
<td><p>Status codes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1address.html">roc_address</a></p></td>
<td><p>Network URIs and addresses</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1packet.html">roc_packet</a></p></td>
<td><p>Network packets and packet processing</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1rtp.html">roc_rtp</a></p></td>
<td><p>RTP support</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1rtcp.html">roc_rtcp</a></p></td>
<td><p>RTCP support</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1fec.html">roc_fec</a></p></td>
<td><p>FEC support</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1sdp.html">roc_sdp</a></p></td>
<td><p>SDP support</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1audio.html">roc_audio</a></p></td>
<td><p>Audio frames and audio processing</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1pipeline.html">roc_pipeline</a></p></td>
<td><p>Pipeline loop that arranges all packet and frame processors into a chain</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1ctl.html">roc_ctl</a></p></td>
<td><p>Control loop that handles signaling protocols and background tasks</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1netio.html">roc_netio</a></p></td>
<td><p>Network I/O loop</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1sndio.html">roc_sndio</a></p></td>
<td><p>Sound I/O loop</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/namespaceroc_1_1node.html">roc_node</a></p></td>
<td><p>Top-level module that glues everything together</p></td>
</tr>
</tbody>
</table>
</section>
<section id="targets">
<span id="id2"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">Targets</a><a class="headerlink" href="#targets" title="Link to this heading">¶</a></h2>
<p>Roc supports multiple platforms and compilers. The major part of the source code is platform-independent. However, there are also parts that depend on specific platform features or optional third-party libraries.</p>
<p>Such platform-dependent code is isolated inside “target” directories. Every target directory corresponds to platform or feature enabled at compile time. When SCons builds the project, it determines target directories to use, depending on the target platform, available third-party libraries, and command-line options.</p>
<p>Every module can have its own target directories. Headers from enabled target directories are added to the include path, and source files from enabled target directories are added to the build.</p>
<p>Currently supported targets are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>target</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>target_pc</p></td>
<td><p>Enabled for PC (like server, desktop, laptop)</p></td>
</tr>
<tr class="row-odd"><td><p>target_posix</p></td>
<td><p>Enabled for a POSIX OS</p></td>
</tr>
<tr class="row-even"><td><p>target_posix_ext</p></td>
<td><p>Enabled for a POSIX OS with POSIX extensions</p></td>
</tr>
<tr class="row-odd"><td><p>target_posix_pc</p></td>
<td><p>Enabled for a POSIX OS on PC</p></td>
</tr>
<tr class="row-even"><td><p>target_gnu</p></td>
<td><p>Enabled for GNU-like libc and compiler</p></td>
</tr>
<tr class="row-odd"><td><p>target_darwin</p></td>
<td><p>Enabled for macOS</p></td>
</tr>
<tr class="row-even"><td><p>target_android</p></td>
<td><p>Enabled for Android</p></td>
</tr>
<tr class="row-odd"><td><p>target_c11</p></td>
<td><p>Enabled for C11 compilers</p></td>
</tr>
<tr class="row-even"><td><p>target_libunwind</p></td>
<td><p>Enabled if libunwind is available</p></td>
</tr>
<tr class="row-odd"><td><p>target_libatomic_ops</p></td>
<td><p>Enabled if libatomic_ops is available</p></td>
</tr>
<tr class="row-even"><td><p>target_libuv</p></td>
<td><p>Enabled if libuv is available</p></td>
</tr>
<tr class="row-odd"><td><p>target_openfec</p></td>
<td><p>Enabled if OpenFEC is available</p></td>
</tr>
<tr class="row-even"><td><p>target_speexdsp</p></td>
<td><p>Enabled if SpeexDSP is available</p></td>
</tr>
<tr class="row-odd"><td><p>target_sox</p></td>
<td><p>Enabled if SoX is available</p></td>
</tr>
<tr class="row-even"><td><p>target_pulseaudio</p></td>
<td><p>Enabled if PulseAudio is available</p></td>
</tr>
<tr class="row-odd"><td><p>target_nobacktrace</p></td>
<td><p>Enabled if no backtrace API is available</p></td>
</tr>
<tr class="row-even"><td><p>target_nodemangle</p></td>
<td><p>Enabled if no demangling API is available</p></td>
</tr>
</tbody>
</table>
<p>Example directory structure employing targets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>roc_core
├── target_posix
│   └── roc_core
│       ├── ...
│       ├── mutex.cpp
│       └── mutex.h
├── target_posix_ext
│   └── roc_core
│       ├── ...
│       ├── time.cpp
│       └── time.h
├── target_darwin
│   └── roc_core
│       ├── ...
│       ├── time.cpp
│       └── time.h
├── ...
├── array.h
└── list.h
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo80.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_project.html">About project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals.html">Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portability.html">Portability</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../internals.html">Internals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Code structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="threads.html">Threads and queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines.html">Media pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="packets_frames.html">Packets and frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestamps.html">Timestamps</a></li>
<li class="toctree-l2"><a class="reference internal" href="fec.html">Forward Erasure Correction codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="fe_resampler.html">Frequency estimator and resampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_protocols.html">Network protocols</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="threads.html" title="Threads and queues"
             >next</a> |</li>
        <li class="right" >
          <a href="glossary.html" title="Glossary"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Roc Toolkit 0.3.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../internals.html" >Internals</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Code structure</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Roc Streaming authors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>